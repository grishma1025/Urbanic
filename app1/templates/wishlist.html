{% extends 'base.html' %}
{% load static %}
{% block body %}

<link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
<link rel="stylesheet" href="{% static 'css/style.css' %}">

<!-- Breadcrumb -->
<div class="breadcrumb-option">
    <div class="container">
        <div class="breadcrumb__links">
            <a href="/"><i class="fa fa-home"></i> Home</a>
            <span>My Wishlist</span>
        </div>
    </div>
</div>

<!-- Wishlist Section -->
<section class="shop spad">
    <div class="container">

        {% if wishlist_items %}
        <div class="row">

            {% for w in wishlist_items %}
            <div class="col-lg-3 col-md-4 col-sm-6">
                
                <div class="product__item">

                    <!-- Product Image -->
                    <div class="product__item__pic set-bg" data-setbg="{{ w.product.image.url }}">
                        {% if w.product.sale %}
                            <div class="label sale">SALE</div>
                        {% endif %}
                        {% if w.product.stock == 0 %}
                            <div class="label stockout">OUT OF STOCK</div>
                        {% endif %}

                        <ul class="product__hover">
                            <li>
                                <a href="{{ w.product.image.url }}" class="image-popup">
                                    <span class="arrow_expand"></span>
                                </a>
                            </li>

                            <li>
                                <a href="{% url 'toggle_wishlist' w.product.id %}">
                                    <span class="icon_heart_alt"></span>
                                </a>
                            </li>

                            <li>
                                <a href="{% url 'add_to_cart' w.product.id %}">
                                    <span class="icon_bag_alt"></span>
                                </a>
                            </li>
                        </ul>
                    </div>

                    <!-- Product Text -->
                    <div class="product__item__text">
                        <h6>
                            <a href="{% url 'product_details' w.product.slug %}">
                                {{ w.product.title }}
                            </a>
                        </h6>

                        <div class="rating">
                            {% for i in "12345"|make_list %}
                                {% if forloop.counter <= w.product.rating %}
                                    <i class="fa fa-star"></i>
                                {% else %}
                                    <i class="fa fa-star-o"></i>
                                {% endif %}
                            {% endfor %}
                        </div>

                        <div class="product__price">
                            ₹ {{ w.product.price }}
                            {% if w.product.old_price %}
                                <span>₹ {{ w.product.old_price }}</span>
                            {% endif %}
                        </div>

                        <!-- Remove Wishlist Button -->
                      <a href="{% url 'toggle_wishlist' product_id=w.product.id %}" class="btn-remove">
    Remove
</a>


                        <!-- Add to Cart -->
                        <a href="{% url 'move_to_cart' product_id=w.product.id %}" class="btn-move-cart mt-2">
    Move to Cart
</a>

                    </div>

                </div>

            </div>
            {% endfor %}

        </div>

        {% else %}
        <div class="text-center py-5">
            <h4>Your wishlist is empty.</h4>
            <a href="/shop/" class="btn btn-primary mt-3">Browse Products</a>
        </div>
        {% endif %}

    </div>
</section>


<!-- Fix set-bg -->
<script>
document.querySelectorAll('.set-bg').forEach(el => {
    el.style.backgroundImage = `url(${el.dataset.setbg})`;
});
</script>

<!-- Wishlist CSS -->
<style>
.btn-remove-wishlist {
    background: #d32f2f;
    padding: 8px 14px;
    border-radius: 6px;
    color: #fff !important;
    font-size: 14px;
    display: inline-block;
    transition: 0.3s;
}
.btn-remove-wishlist:hover {
    background: #b71c1c;
}

.btn-add-cart {
    background: #1976d2;
    padding: 8px 14px;
    border-radius: 6px;
    color: #fff !important;
    font-size: 14px;
    display: inline-block;
    transition: 0.3s;
}
.btn-add-cart:hover {
    background: #125a9c;
}

.btn-move-cart {
    background: #28a745;
    padding: 8px 14px;
    border-radius: 6px;
    color: white !important;
    display: inline-block;
    font-size: 14px;
    font-weight: 600;
    transition: 0.3s;
}
.btn-move-cart:hover {
    background: #1e7e34;
}

</style>

{% endblock %}
